const express = require("express");
const fs = require("fs");
const cors = require("cors");

const app = express();
const PORT = process.env.PORT || 3000;

// ØªÙØ¹ÙŠÙ„ CORS Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø£ÙŠ Ù…ÙˆÙ‚Ø¹
app.use(cors());
app.use(express.json()); // Ù„ÙÙ‡Ù… Ø¨ÙŠØ§Ù†Ø§Øª JSON Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©

// Ù†Ù‚Ø·Ø© Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
app.post("/save-data", (req, res) => {
    const scrapedData = req.body; // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ÙƒØ±Ø©Ø¨Ø©

    // ØªØ®Ø²ÙŠÙ†Ù‡Ø§ ÙÙŠ Ù…Ù„Ù JSON
    fs.writeFileSync("scraped_data.json", JSON.stringify(scrapedData, null, 2));

    console.log("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!");
    res.status(200).json({ message: "âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ù†Ø¬Ø§Ø­!" });
});

// ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±
app.listen(PORT, () => console.log(`ğŸš€ Server is running on port ${PORT}`));
